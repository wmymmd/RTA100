VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "comdlg32.ocx"
Begin VB.Form frmRecipe 
   Caption         =   "Recipe"
   ClientHeight    =   10830
   ClientLeft      =   60
   ClientTop       =   525
   ClientWidth     =   15240
   LinkTopic       =   "Form1"
   ScaleHeight     =   10830
   ScaleWidth      =   15240
   WindowState     =   2  '最大化
   Begin VB.Frame Frame2 
      Height          =   1455
      Index           =   200
      Left            =   240
      TabIndex        =   48
      Top             =   0
      Width           =   14775
      Begin VB.ComboBox cboInputControl 
         BackColor       =   &H00E0E0E0&
         ForeColor       =   &H000000FF&
         Height          =   300
         Left            =   12480
         Style           =   2  '單純下拉式
         TabIndex        =   52
         Top             =   480
         Width           =   1215
      End
      Begin VB.ComboBox cboHolder 
         BackColor       =   &H00E0E0E0&
         ForeColor       =   &H000000FF&
         Height          =   300
         Left            =   12480
         Style           =   2  '單純下拉式
         TabIndex        =   51
         Top             =   960
         Width           =   1215
      End
      Begin VB.Label label 
         Alignment       =   1  '靠右對齊
         Caption         =   "Control Element"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   12
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   375
         Index           =   5
         Left            =   10440
         TabIndex        =   54
         Top             =   480
         Width           =   1815
      End
      Begin VB.Label lable 
         Alignment       =   1  '靠右對齊
         Caption         =   "Holder Type"
         BeginProperty Font 
            Name            =   "新細明體"
            Size            =   12
            Charset         =   136
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   375
         Index           =   6
         Left            =   10200
         TabIndex        =   53
         Top             =   960
         Width           =   2055
      End
      Begin VB.Label lblRecipeFile 
         AutoSize        =   -1  'True
         BorderStyle     =   1  '單線固定
         Caption         =   "unknow.rcp"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   330
         Left            =   1560
         TabIndex        =   50
         Top             =   960
         Width           =   1230
      End
      Begin VB.Label Label1 
         AutoSize        =   -1  'True
         Caption         =   "Recipe File :"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   270
         Left            =   120
         TabIndex        =   49
         Top             =   960
         Width           =   1320
      End
   End
   Begin VB.Frame Frame1 
      Height          =   7695
      Left            =   240
      TabIndex        =   0
      Top             =   1440
      Width           =   14775
      Begin VB.Frame fraExternal 
         Height          =   5415
         Left            =   120
         TabIndex        =   1
         Top             =   960
         Width           =   14295
         Begin VB.Frame fraRecipe 
            Height          =   18735
            Left            =   120
            TabIndex        =   2
            Top             =   0
            Width           =   13455
            Begin VB.HScrollBar hsbStep 
               Height          =   350
               Index           =   0
               Left            =   840
               Max             =   3
               Min             =   1
               TabIndex        =   13
               Top             =   240
               Value           =   1
               Width           =   495
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   9
               Left            =   12240
               MaxLength       =   8
               TabIndex        =   12
               Top             =   240
               Width           =   1215
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   8
               Left            =   11040
               MaxLength       =   8
               TabIndex        =   11
               Top             =   240
               Width           =   1215
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   7
               Left            =   9840
               MaxLength       =   8
               TabIndex        =   10
               Top             =   240
               Width           =   1215
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   6
               Left            =   8640
               MaxLength       =   8
               TabIndex        =   9
               Top             =   240
               Width           =   1215
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   5
               Left            =   7440
               MaxLength       =   8
               TabIndex        =   8
               Top             =   240
               Width           =   1215
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   4
               Left            =   6240
               MaxLength       =   8
               TabIndex        =   7
               Top             =   240
               Width           =   1215
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   3
               Left            =   5040
               MaxLength       =   8
               TabIndex        =   6
               Top             =   240
               Width           =   1215
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   2
               Left            =   3840
               MaxLength       =   8
               TabIndex        =   5
               Top             =   240
               Width           =   1215
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               IMEMode         =   2  '關閉
               Index           =   0
               Left            =   840
               Locked          =   -1  'True
               TabIndex        =   3
               Top             =   240
               Width           =   1815
            End
            Begin VB.TextBox txtStep 
               Alignment       =   1  '靠右對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   12
                  Charset         =   136
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Index           =   1
               Left            =   2640
               MaxLength       =   8
               TabIndex        =   4
               Top             =   240
               Width           =   1215
            End
            Begin VB.Label lblStep 
               Alignment       =   2  '置中對齊
               Appearance      =   0  '平面
               BackColor       =   &H00E0E0E0&
               BorderStyle     =   1  '單線固定
               Caption         =   "1"
               BeginProperty Font 
                  Name            =   "新細明體"
                  Size            =   15.75
                  Charset         =   136
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H80000008&
               Height          =   375
               Index           =   0
               Left            =   360
               TabIndex        =   14
               Top             =   240
               Width           =   495
            End
         End
         Begin VB.VScrollBar VScroll1 
            Height          =   5415
            Left            =   13800
            Max             =   35
            TabIndex        =   47
            Top             =   0
            Width           =   375
         End
      End
      Begin VB.Frame fraTitle 
         Height          =   975
         Left            =   240
         TabIndex        =   26
         Top             =   120
         Width           =   14175
         Begin VB.Label Label5 
            Alignment       =   2  '置中對齊
            Caption         =   "TYPE"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   0
            Left            =   1440
            TabIndex        =   46
            Top             =   240
            Width           =   1095
         End
         Begin VB.Label Label5 
            Alignment       =   2  '置中對齊
            Caption         =   "TEMP"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   2
            Left            =   3960
            TabIndex        =   45
            Top             =   240
            Width           =   1095
         End
         Begin VB.Label lblGas4Name 
            Alignment       =   2  '置中對齊
            Caption         =   "Temp."
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   8640
            TabIndex        =   44
            Top             =   240
            Width           =   1215
         End
         Begin VB.Label lblGas5Name 
            Alignment       =   2  '置中對齊
            Caption         =   "Temp."
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   9720
            TabIndex        =   43
            Top             =   240
            Width           =   1335
         End
         Begin VB.Label lblGas6Name 
            Alignment       =   2  '置中對齊
            Caption         =   "Gas6(X)"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   11040
            TabIndex        =   42
            Top             =   240
            Width           =   1215
         End
         Begin VB.Label lblGas7Name 
            Alignment       =   2  '置中對齊
            Caption         =   "GAS7(X)"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   12240
            TabIndex        =   41
            Top             =   240
            Width           =   1095
         End
         Begin VB.Label Label5 
            Alignment       =   2  '置中對齊
            Caption         =   "(SEC)"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   10
            Left            =   2760
            TabIndex        =   40
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label Label5 
            Alignment       =   2  '置中對齊
            Caption         =   "(C)"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   11
            Left            =   3960
            TabIndex        =   39
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label lblGas4SLPMName 
            Alignment       =   2  '置中對齊
            Caption         =   "Min"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Left            =   8640
            TabIndex        =   38
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label lblGas5SLPMName 
            Alignment       =   2  '置中對齊
            Caption         =   "Max"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Left            =   9840
            TabIndex        =   37
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label lblGas6SLPMName 
            Alignment       =   2  '置中對齊
            Caption         =   "SLPM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Left            =   11040
            TabIndex        =   36
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label lblGas7SLPMName 
            Alignment       =   2  '置中對齊
            Caption         =   "SLPM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Left            =   12240
            TabIndex        =   35
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label Label5 
            Alignment       =   2  '置中對齊
            Caption         =   "STEP"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   19
            Left            =   360
            TabIndex        =   34
            Top             =   240
            Width           =   855
         End
         Begin VB.Label lblGas1Name 
            Alignment       =   2  '置中對齊
            Caption         =   "O2"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   5040
            TabIndex        =   33
            Top             =   240
            Width           =   1215
         End
         Begin VB.Label lblGas2Name 
            Alignment       =   2  '置中對齊
            Caption         =   "N2"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   6240
            TabIndex        =   32
            Top             =   240
            Width           =   1215
         End
         Begin VB.Label lblGas3Name 
            Alignment       =   2  '置中對齊
            Caption         =   "GAS3"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Left            =   7440
            TabIndex        =   31
            Top             =   240
            Width           =   1215
         End
         Begin VB.Label lblGas1SLPMName 
            Alignment       =   2  '置中對齊
            Caption         =   "SLPM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Left            =   5040
            TabIndex        =   30
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label lblGas2SLPMName 
            Alignment       =   2  '置中對齊
            Caption         =   "SLPM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Left            =   6240
            TabIndex        =   29
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label lblGas3SLPMName 
            Alignment       =   2  '置中對齊
            Caption         =   "SLPM"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Left            =   7440
            TabIndex        =   28
            Top             =   480
            Width           =   1095
         End
         Begin VB.Label Label5 
            Alignment       =   2  '置中對齊
            Caption         =   "TIME"
            BeginProperty Font 
               Name            =   "Arial"
               Size            =   12
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   1
            Left            =   2760
            TabIndex        =   27
            Top             =   240
            Width           =   1095
         End
      End
      Begin VB.Frame fraPID 
         Height          =   1095
         Left            =   600
         TabIndex        =   15
         Top             =   6480
         Width           =   13095
         Begin VB.TextBox txtRecipeControl 
            Appearance      =   0  '平面
            BackColor       =   &H00E0E0E0&
            Height          =   270
            Index           =   7
            Left            =   9360
            TabIndex        =   59
            Top             =   720
            Width           =   975
         End
         Begin VB.TextBox txtRecipeControl 
            Appearance      =   0  '平面
            BackColor       =   &H00E0E0E0&
            Height          =   270
            Index           =   6
            Left            =   11760
            TabIndex        =   57
            Top             =   360
            Width           =   975
         End
         Begin VB.TextBox txtRecipeControl 
            Appearance      =   0  '平面
            BackColor       =   &H00E0E0E0&
            Height          =   270
            Index           =   5
            Left            =   9360
            TabIndex        =   55
            Top             =   360
            Width           =   975
         End
         Begin VB.TextBox txtRecipeControl 
            Appearance      =   0  '平面
            BackColor       =   &H00E0E0E0&
            Height          =   270
            Index           =   4
            Left            =   11760
            TabIndex        =   20
            Top             =   360
            Width           =   975
         End
         Begin VB.TextBox txtRecipeControl 
            Appearance      =   0  '平面
            BackColor       =   &H00E0E0E0&
            Height          =   270
            Index           =   3
            Left            =   9360
            TabIndex        =   19
            Top             =   360
            Width           =   975
         End
         Begin VB.TextBox txtRecipeControl 
            Appearance      =   0  '平面
            BackColor       =   &H00E0E0E0&
            Height          =   270
            Index           =   2
            Left            =   6480
            TabIndex        =   18
            Top             =   360
            Width           =   975
         End
         Begin VB.TextBox txtRecipeControl 
            Appearance      =   0  '平面
            BackColor       =   &H00E0E0E0&
            Height          =   270
            Index           =   1
            Left            =   3840
            TabIndex        =   17
            Top             =   360
            Width           =   975
         End
         Begin VB.TextBox txtRecipeControl 
            Appearance      =   0  '平面
            BackColor       =   &H00E0E0E0&
            Height          =   270
            Index           =   0
            Left            =   1560
            TabIndex        =   16
            Top             =   360
            Width           =   975
         End
         Begin VB.Label Label2 
            Caption         =   "PreHeat Power(%)"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   255
            Index           =   7
            Left            =   7440
            TabIndex        =   60
            Top             =   720
            Width           =   1815
         End
         Begin VB.Label Label2 
            Alignment       =   1  '靠右對齊
            Caption         =   "Temp Stop"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   6
            Left            =   10560
            TabIndex        =   58
            Top             =   360
            Width           =   1095
         End
         Begin VB.Label Label2 
            Alignment       =   1  '靠右對齊
            Caption         =   "Shift"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   5
            Left            =   8160
            TabIndex        =   56
            Top             =   360
            Width           =   1095
         End
         Begin VB.Label Label2 
            Alignment       =   1  '靠右對齊
            Caption         =   "Control 2"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   4
            Left            =   10560
            TabIndex        =   25
            Top             =   360
            Width           =   1095
         End
         Begin VB.Label Label2 
            Alignment       =   1  '靠右對齊
            Caption         =   "Control1"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   3
            Left            =   8160
            TabIndex        =   24
            Top             =   360
            Width           =   1095
         End
         Begin VB.Label Label2 
            Alignment       =   1  '靠右對齊
            Caption         =   "Derivative"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   2
            Left            =   5040
            TabIndex        =   23
            Top             =   360
            Width           =   1335
         End
         Begin VB.Label Label2 
            Alignment       =   1  '靠右對齊
            Caption         =   "Integral"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   1
            Left            =   2880
            TabIndex        =   22
            Top             =   360
            Width           =   855
         End
         Begin VB.Label Label2 
            Alignment       =   1  '靠右對齊
            Caption         =   "Proportion"
            BeginProperty Font 
               Name            =   "新細明體"
               Size            =   12
               Charset         =   136
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   375
            Index           =   0
            Left            =   120
            TabIndex        =   21
            Top             =   360
            Width           =   1335
         End
      End
   End
   Begin MSComDlg.CommonDialog comRecipe 
      Left            =   120
      Top             =   9720
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
      CancelError     =   -1  'True
      DefaultExt      =   "rcp"
      Filter          =   "Recipe File(*.rcp)|*.rcp"
   End
End
Attribute VB_Name = "frmRecipe"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

' Recipe Const
Private Const gbcntRampLimite = 50
Private Const TypeNumber = 7
Private Const StepItem = 10
Private Const StepNumber = 50
Private Const GasNumber = 7

'InputControl
Enum InputControl
    ThermalCouple_1 = 0
    Pyrometer_1 = 1
    ThermalCouple_2 = 2
End Enum

'txtStep's Index
Private Const TYPE1 = 0
Private Const STEPTIME = 1
Private Const TEMP = 2
Private Const GAS1 = 3
Private Const GAS2 = 4
Private Const GAS3 = 5
Private Const GAS4 = 6
Private Const GAS5 = 7
Private Const GAS6 = 8
Private Const GAS7 = 9


'Configuration
Private gblTimeMax As Long
Private gblTempMax As Long

Private gblGas1FlowMax As Long
Private gblGas2FlowMax As Long
Private gblGas3FlowMax As Long
Private gblGas4FlowMax As Long
Private gblGas5FlowMax As Long
Private gblGas6FlowMax As Long
Private gblGas7FlowMax As Long

Private gblGas1Plot As Boolean
Private gblGas2Plot As Boolean
Private gblGas3Plot As Boolean
Private gblGas4Plot As Boolean
Private gblGas5Plot As Boolean
Private gblGas6Plot As Boolean
Private gblGas7Plot As Boolean

'Recipe

Private gbblnInitialModify  As Boolean
Private gbblnRecipeModify  As Boolean
Private gbblnRecipePIDModify  As Boolean

Private gbstrRecipeOldData(1 To StepItem) As String

Private gblngActiveStep As Long

Dim i As Integer

Private Sub cboHolder_Click()
    gbblnRecipeModify = Not gbblnInitialModify
End Sub

Private Sub cboInputControl_Click()
    gbblnRecipeModify = Not gbblnInitialModify
End Sub

Private Sub Form_Activate()
    'WhatSave = 2
End Sub

Public Sub Form_Deactivate()
'    Dim lngState As Long
'
'    If gbblnRecipeModify Or gbblnRecipePIDModify Then
'        'mdiRtp.mnuRecipe_Click
'        lngState = MessageQuestion(Warning_2000)
'        If lngState = vbYes Then
'            mdiRtp.mnuSave_Click
'            'Call RecipeSave
'        Else
'            If Right(lblRecipeFile, 10) <> "(Not Save)" Then lblRecipeFile = lblRecipeFile & "(Not Save)"
'        End If
'        gbblnRecipePIDModify = False
'        gbblnRecipeModify = False
'    End If
End Sub

Private Sub Form_Load()
    Dim i As Long, j As Long

    'Call RemoveMenus(Me.hwnd, True, True, True, True, False, False, False, False, False)
'    Call RemoveMenus(Me.hWnd, True, True, True, True, _
'                    True, True, True, True, True)
    frmRecipe.cboInputControl.Clear
    frmRecipe.cboInputControl.AddItem ("TC_C")
    frmRecipe.cboInputControl.AddItem ("PM")
    frmRecipe.cboInputControl.ListIndex = 1
    cboInputControl.Locked = True
    cboInputControl.Enabled = False
    
    frmRecipe.cboHolder.Clear
    frmRecipe.cboHolder.AddItem ("Wafer")
    frmRecipe.cboHolder.AddItem ("Graphite")
    frmRecipe.cboHolder.ListIndex = 0
    cboHolder.Locked = True
    cboHolder.Enabled = False
    
    fraRecipe.Top = -240
    VScroll1.Max = StepNumber - 15
    
    For i = 3 To 4
        txtRecipeControl(i).Visible = False
        Label2(i).Visible = False
    Next i
    
    '******************************************Create Resipe grid structure ******************************************
    For i = 1 To StepNumber - 1
        Load lblStep(i)
        lblStep(i).Caption = i + 1
        lblStep(i).Top = lblStep(i - 1).Top + lblStep(i - 1).Height - 15
        lblStep(i).Left = lblStep(i - 1).Left
        lblStep(i).Visible = True
        lblStep(i).ZOrder
        For j = 0 To StepItem - 1
            Load txtStep(i * 10 + j)
            txtStep(i * 10 + j).Width = txtStep((i - 1) * StepItem + j).Width
            txtStep(i * 10 + j).Height = txtStep((i - 1) * StepItem + j).Height
            txtStep(i * 10 + j).Top = txtStep((i - 1) * StepItem + j).Top + txtStep((i - 1) * StepItem + j).Height - 15
            txtStep(i * 10 + j).Left = txtStep((i - 1) * StepItem + j).Left
            txtStep(i * 10 + j).MaxLength = txtStep((i - 1) * StepItem + j).MaxLength
            txtStep(i * 10 + j).Locked = False
            txtStep(i * 10 + j).Visible = True
            txtStep(i * 10 + j).ZOrder
        Next j
    
        Load hsbStep(i)
        hsbStep(i).Top = hsbStep(i - 1).Top + hsbStep(i - 1).Height + 10
        hsbStep(i).Left = hsbStep(i - 1).Left
        hsbStep(i).Visible = True
        hsbStep(i).ZOrder
    Next i
        
    '******************************************edit  structure ******************************************
    For i = 0 To StepNumber - 1
        hsbStep(i).Min = 5 - TypeNumber
    Next i
    
    hsbStep(0).Max = 3
    
    For i = 1 To StepNumber - 1
        hsbStep(i).Max = 4
    Next i
            
    For i = 0 To StepNumber - 1
        hsbStep(i).Value = 1
    Next i
    
    fraTitle.BorderStyle = 0
    fraExternal.BorderStyle = 0
    fraRecipe.BorderStyle = 0
    lblRecipeFile.BorderStyle = 0
    
    
    gblTimeMax = 9999
    gblTempMax = 1100
    gblGas1FlowMax = 30
    gblGas2FlowMax = 30
    gblGas3FlowMax = 30
    gblGas4FlowMax = 1500
    gblGas5FlowMax = 1500
    gblGas6FlowMax = 30
    gblGas7FlowMax = 30
End Sub



Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
   ' If UnloadMode <> vbFormCode Then Cancel = True
End Sub

Private Sub Form_Unload(Cancel As Integer)
    'End
End Sub

Private Sub hsbStep_Change(Index As Integer)
    ' the last step must be "Stop"
    If Index = StepNumber - 1 Then hsbStep(Index).Value = 1
    Call ShowText(hsbStep(Index), txtStep(Index * 10))
    Call TypeAction(txtStep(Index * 10))
End Sub

Private Sub lblStep_MouseDown(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
    Dim lngOldColor As Long
    
    gblngActiveStep = Index + 1
    If Button = 2 Then
        lngOldColor = txtStep(Index * StepItem).BackColor
        For i = 1 To StepItem
            txtStep((i - 1) + (Index) * StepItem).BackColor = GB_ColorBlue
        Next i
        'PopupMenu mdiRtp.mnuEdit
 
        For i = 1 To StepItem
            txtStep((i - 1) + (Index) * StepItem).BackColor = lngOldColor
        Next i
    End If
End Sub

Private Sub txtRecipeControl_Change(Index As Integer)
    gbblnRecipePIDModify = Not gbblnInitialModify
End Sub

Private Sub txtRecipeControl_KeyPress(Index As Integer, KeyAscii As Integer)
    'KeyAscii = 46 -->Point
    'KeyAscii =  8 -->Back Space
    If KeyAscii <> 8 And KeyAscii <> 46 And KeyAscii <> 45 And (KeyAscii < 48 Or KeyAscii > 57) Then
        KeyAscii = 0
    End If
End Sub

Public Sub txtStep_Change(Index As Integer)
    Dim Check As Integer
    
    Check = Index Mod StepItem
    Select Case Check
        Case 0
            Select Case txtStep(Index).Text
                Case "Ramp"
                    hsbStep(Index \ StepItem).Value = 3
                Case "Hold"
                    hsbStep(Index \ StepItem).Max = 4
                    hsbStep(Index \ StepItem).Value = 4
                Case "Idle"
                    hsbStep(Index \ StepItem).Value = 2
                Case "Stop"
                    hsbStep(Index \ StepItem).Value = 1
                Case "PreHeat"
                    hsbStep(Index \ StepItem).Value = 0
                Case "PumpDown"
                    hsbStep(Index \ StepItem).Value = -1
                Case "Keep_PD"
                    hsbStep(Index \ StepItem).Value = -2
            End Select
        Case 1
            If Val(txtStep(Index).Text) > gblTimeMax Then
                txtStep(Index).Text = CStr(gblTimeMax)
            End If
        Case 2
            If Val(txtStep(Index).Text) > gblTempMax Then
                txtStep(Index).Text = CStr(gblTempMax)
            End If
        Case 3
            If Val(txtStep(Index).Text) > gblGas1FlowMax Then
                txtStep(Index).Text = CStr(gblGas1FlowMax)
            End If
        Case 4
            If Val(txtStep(Index).Text) > gblGas2FlowMax Then
                txtStep(Index).Text = CStr(gblGas2FlowMax)
            End If
        Case 5
            If Val(txtStep(Index).Text) > gblGas3FlowMax Then
                txtStep(Index).Text = CStr(gblGas3FlowMax)
            End If
        Case 6
            If Val(txtStep(Index).Text) > gblGas4FlowMax Then
                txtStep(Index).Text = CStr(gblGas4FlowMax)
            End If
        Case 7
            If Val(txtStep(Index).Text) > gblGas5FlowMax Then
                txtStep(Index).Text = CStr(gblGas5FlowMax)
            End If
        Case 8
            If Val(txtStep(Index).Text) > gblGas6FlowMax Then
                txtStep(Index).Text = CStr(gblGas6FlowMax)
            End If
        Case 9
            If Val(txtStep(Index).Text) > gblGas7FlowMax Then
                txtStep(Index).Text = CStr(gblGas7FlowMax)
            End If
    End Select
    
    gbblnRecipeModify = Not gbblnInitialModify
            
End Sub

Private Sub txtStep_KeyPress(Index As Integer, KeyAscii As Integer)
    ' keyascii 46 is (.)
    If KeyAscii <> 8 And KeyAscii <> 46 And (KeyAscii < 48 Or KeyAscii > 57) Then
        KeyAscii = 0
    End If

'    If KeyAscii <> 8 And (Index Mod StepItem <> 1 And KeyAscii = 46) And (KeyAscii < 48 Or KeyAscii > 57) Then
'        KeyAscii = 0
'    End If
End Sub

Public Sub TypeAction(txtobject As TextBox, Optional IsSave As Boolean)
    Dim i As Long
    Dim Index As Long

    Index = txtobject.Index
    
    Select Case txtobject.Text
        Case "PreHeat"
            txtStep(Index + STEPTIME).Text = "0"
        Case "Idle"
            ' If IsSave Then txtStep(Index + Temp).Text = "0"
            txtStep(Index + TEMP).Text = "0"
        Case "Ramp"
            '**********************************Ramp Limite 50/s must use cboHolder.ListIndex = 1 not gbbytholder=1 **************************
            '**********************************because recipesave() not refresh gbbytholder
            If cboHolder.ListIndex = InputControl.Pyrometer_1 And Index = 0 Then
                txtStep(Index + STEPTIME).Text = Format(CStr(Abs(Val(txtStep(Index + TEMP).Text) - 0) \ gbcntRampLimite), "0.00")
            End If
            For i = Index - StepItem To 0 Step -StepItem
                Select Case txtStep(i).Text
                    Case "Ramp", "Hold", "Idle"
                        If cboHolder.ListIndex = InputControl.Pyrometer_1 Then
                            If Val(txtStep(Index + STEPTIME).Text) = 0 Then
                                txtStep(Index + STEPTIME).Text = Format(CStr(Abs(Val(txtStep(Index + TEMP).Text) - Val(txtStep(i + TEMP).Text)) \ gbcntRampLimite), "0.00")
                            Else
                                If (Abs(Val(txtStep(Index + TEMP).Text) - Val(txtStep(i + TEMP).Text)) / Val(txtStep(Index + STEPTIME).Text)) > gbcntRampLimite Then
                                    txtStep(Index + STEPTIME).Text = Format(CStr(Abs(Val(txtStep(Index + TEMP).Text) - Val(txtStep(i + TEMP).Text)) \ gbcntRampLimite), "0.00")
                                End If
                            End If
                        End If
                        Exit For
                    Case "Stop"
                        Exit For
                    Case Else
                        If cboHolder.ListIndex = InputControl.Pyrometer_1 And i = 0 Then
                            If Val(txtStep(Index + STEPTIME).Text) = 0 Then
                                txtStep(Index + STEPTIME).Text = Format(CStr(Abs(Val(txtStep(Index + TEMP).Text) - 0) \ gbcntRampLimite), "0.00")
                            Else
                                If (Abs(Val(txtStep(Index + TEMP).Text) - Val(txtStep(i + TEMP).Text)) / Val(txtStep(Index + STEPTIME).Text)) > gbcntRampLimite Then
                                txtStep(Index + STEPTIME).Text = Format(CStr(Abs(Val(txtStep(Index + TEMP).Text) - Val(txtStep(i + TEMP).Text)) \ gbcntRampLimite), "0.00")
                            End If
                        End If
                        Exit For
                    End If
                End Select
            Next i
        Case "Hold"
            '**********************************Ramp Limite 50/s must use cboHolder.ListIndex = 1 not gbbytholder=1 **************************
            '**********************************because recipesave() not refresh gbbytholder
            If cboHolder.ListIndex = InputControl.Pyrometer_1 And Index = 0 And Val(txtStep(Index + STEPTIME).Text) <> 0 Then
                Call RecipeInsert((Index \ StepItem) + 1, 3)
            End If
            'prestep
            For i = Index - StepItem To 0 Step -StepItem
                Select Case txtStep(i).Text
                    Case "Ramp", "Hold", "PreHeat"
                        txtStep(Index + TEMP).Text = txtStep(i + TEMP).Text
                        Exit For
                    Case "Idle"
                        If cboHolder.ListIndex = InputControl.Pyrometer_1 Then
                            If Val(txtStep(Index + STEPTIME).Text) = 0 Then
                            
                            Else
                                If (Abs(Val(txtStep(Index + TEMP).Text) - Val(txtStep(i + TEMP).Text)) / Val(txtStep(Index + STEPTIME).Text)) > gbcntRampLimite Then
                                    ''''insert ramp step
                                    Call RecipeInsert((Index \ StepItem) + 1, 3)
                                End If
                            End If
                        End If
                        Exit For
                    Case "Stop"
                        Exit For
                    
                    Case Else
                        If cboHolder.ListIndex = InputControl.Pyrometer_1 And i = 0 Then
                            If Val(txtStep(Index + STEPTIME).Text) = 0 Then
                            
                            Else
                                If (Abs(Val(txtStep(Index + TEMP).Text) - Val(txtStep(i + TEMP).Text)) / Val(txtStep(Index + STEPTIME).Text)) > gbcntRampLimite Then
                                    ''''insert ramp step
                                    Call RecipeInsert((Index \ StepItem) + 1, 3)
                                End If
                            End If
                            Exit For
                        End If
                End Select
            Next i
     
        Case "PumpDown", "Keep_PD"
            ''''some process need flow gas with pumping
            ''''''  For i = STEPTIME To GAS7
            ''''''
            ''''''       txtStep(Index + i).Text = "0"
            ''''''
            ''''''      Next i
        
        Case "Stop"
    End Select

End Sub

Public Function RecipeOpen(Initial As Boolean, Optional CallProcessRecipOpen As Boolean = False) As Boolean

    Dim FileName As String
    Dim strData As String * 15
    Dim lngRet As Long
    Dim i As Long, j As Long
    Const lngConValueSize = 15
    
    gbblnInitialModify = True
           
    On Error GoTo RecipeOpenError
    
    Select Case Initial
        Case True
            FileName = App.path & "\TBR.rcp"
            If Dir(FileName) = "" Then GoTo RecipeOpenError
        Case False
            FileName = comRecipe.FileName
    End Select
    
    For i = 1 To StepNumber
        lngRet = GetPrivateProfileString("STEP" & Str(i), "TIME", "", strData, lngConValueSize, FileName)
        txtStep(STEPTIME + (i - 1) * StepItem).Text = strData
      
        lngRet = GetPrivateProfileString("STEP" & Str(i), "TEMP", "", strData, lngConValueSize, FileName)
        txtStep(TEMP + (i - 1) * StepItem).Text = strData
        
        lngRet = GetPrivateProfileString("STEP" & Str(i), "GAS1", "", strData, lngConValueSize, FileName)
        txtStep(GAS1 + (i - 1) * StepItem).Text = strData
       
        lngRet = GetPrivateProfileString("STEP" & Str(i), "GAS2", "", strData, lngConValueSize, FileName)
        txtStep(GAS2 + (i - 1) * StepItem).Text = strData
       
        lngRet = GetPrivateProfileString("STEP" & Str(i), "GAS3", "", strData, lngConValueSize, FileName)
        txtStep(GAS3 + (i - 1) * StepItem).Text = strData
         
        lngRet = GetPrivateProfileString("STEP" & Str(i), "GAS4", "", strData, lngConValueSize, FileName)
        txtStep(GAS4 + (i - 1) * StepItem).Text = strData
          
        lngRet = GetPrivateProfileString("STEP" & Str(i), "GAS5", "", strData, lngConValueSize, FileName)
        txtStep(GAS5 + (i - 1) * StepItem).Text = strData
        
        lngRet = GetPrivateProfileString("STEP" & Str(i), "GAS6", "", strData, lngConValueSize, FileName)
        txtStep(GAS6 + (i - 1) * StepItem).Text = strData
      
        lngRet = GetPrivateProfileString("STEP" & Str(i), "GAS7", "", strData, lngConValueSize, FileName)
        txtStep(GAS7 + (i - 1) * StepItem).Text = strData
        
        lngRet = GetPrivateProfileString("STEP" & Str(i), "TYPE", "", strData, lngConValueSize, FileName)
        
        j = InStr(1, strData, Chr(0), vbTextCompare)
        
        Select Case Mid(strData, 1, j - 1)
            Case "Keep_PD"
               hsbStep(i - 1).Value = -2
            Case "PumpDown"
               hsbStep(i - 1).Value = -1
            Case "PreHeat"
               hsbStep(i - 1).Value = 0
            Case "Ramp"
               hsbStep(i - 1).Value = 3
            Case "Hold"
                hsbStep(i - 1).Value = 4
            Case "Idle"
              hsbStep(i - 1).Value = 2
            Case "Stop"
               hsbStep(i - 1).Value = 1
        End Select
    Next i
            
    'Open PID COntrol Parameter
    lngRet = GetPrivateProfileString("Control Parameter", "Porprotion", "", strData, lngConValueSize, FileName)
    txtRecipeControl(0).Text = strData
    
    lngRet = GetPrivateProfileString("Control Parameter", "Integral", "", strData, lngConValueSize, FileName)
    txtRecipeControl(1).Text = strData
    
    lngRet = GetPrivateProfileString("Control Parameter", "Derivetive", "", strData, lngConValueSize, FileName)
    txtRecipeControl(2).Text = strData
    
    lngRet = GetPrivateProfileString("Control Parameter", "Feed_Forward", "", strData, lngConValueSize, FileName)
    txtRecipeControl(3).Text = strData
    
    lngRet = GetPrivateProfileString("Control Parameter", "Predict", "", strData, lngConValueSize, FileName)
    txtRecipeControl(4).Text = strData

    lngRet = GetPrivateProfileString("Control Parameter", "Shift", "", strData, lngConValueSize, FileName)
    txtRecipeControl(5).Text = strData
    
    lngRet = GetPrivateProfileString("Control Parameter", "Auto Temp Stop", "", strData, lngConValueSize, FileName)
    txtRecipeControl(6).Text = strData
    
    lngRet = GetPrivateProfileString("Control Parameter", "Preheat Power", "", strData, lngConValueSize, FileName)
    txtRecipeControl(7).Text = strData
    
    lngRet = GetPrivateProfileString("Control Source", "Input", "", strData, lngConValueSize, FileName)
    cboInputControl.ListIndex = Val(strData)
    
    lngRet = GetPrivateProfileString("Control Source", "Holder", "", strData, lngConValueSize, FileName)
    cboHolder.ListIndex = Val(strData)
        
'    If CallProcessRecipOpen Then
'        frmDisplay.comDisplayRecipe.FileName = comRecipe.FileName
'        Call frmDisplay.DisplayRecipeOpen(False)
'    End If
        
    If Not Initial Then
        lblRecipeFile.Caption = FileName 'GetFileName(FileName)
    End If
        
    gbblnInitialModify = False
      
    RecipeOpen = True
          
    Exit Function
  
RecipeOpenError:
    RecipeOpen = False
    lblRecipeFile.Caption = ""
    
    gbblnInitialModify = False
            
'    Select Case Initial
'    Case True
'        Call MessageWarning(Error_2000, vbModal)
'    Case False
'        Call MessageWarning(Error_2005, vbModal)
'    End Select
End Function

Public Function RecipeSave(Optional CallProcessRecipeOpen As Boolean = True) As Boolean

    Dim i As Long, j As Long
    Dim FileName As String
    Dim Re As Long
    Dim lngMaxTemp As Long
    
    On Error GoTo RecipeSaveError
 
    FileName = comRecipe.FileName
    
    'correct data & Fill the space textbox to "0"
    For i = 1 To StepNumber
        Call TypeAction(txtStep((i - 1) * StepItem), True)
    Next i
        
    For i = 1 To StepNumber
        For j = STEPTIME To GAS7
            Call txtStep_Change((i - 1) * StepItem + j)
            If txtStep((i - 1) * StepItem + j).Text = "" Then txtStep((i - 1) * StepItem + j).Text = "0"
        Next j
    Next i
    '********************Check Control Feedback*****************************************************
'    If gblngUserLevel <> ADMINISTRATOR Then
'        For i = 1 To StepNumber
'            If txtStep((i - 1) * StepItem).Text = "Stop" Then Exit For
'            If Val(txtStep((i - 1) * StepItem + TEMP).Text) > lngMaxTemp Then
'                lngMaxTemp = Val(txtStep((i - 1) * StepItem + TEMP).Text)
'            End If
'        Next i
'
'        Select Case lngMaxTemp
'            Case Is > Val(frmConfiguration.txtTCControlMaxTemp)
'                If cboInputControl.ListIndex = 0 Then
'                    Call MessageWarning(Warning_2005, vbModeless)
'                    cboInputControl.ListIndex = 1  'Pyrometer
'                End If
'            Case Is < Val(frmConfiguration.txtPMControlMinTemp)
'                If cboInputControl.ListIndex = 1 Then
'                    Call MessageWarning(Warning_2010, vbModeless)
'                    cboInputControl.ListIndex = 0   'TC
'                End If
'        End Select
'    End If

    '***********************************************************************************

    
    For i = 1 To StepNumber
        Re = WritePrivateProfileString("STEP" & Str(i), "TYPE", txtStep(TYPE1 + (i - 1) * StepItem).Text, FileName)
         
        Re = WritePrivateProfileString("STEP" & Str(i), "TIME", txtStep(STEPTIME + (i - 1) * StepItem).Text, FileName)
        
        Re = WritePrivateProfileString("STEP" & Str(i), "TEMP", txtStep(TEMP + (i - 1) * StepItem).Text, FileName)
        
        Re = WritePrivateProfileString("STEP" & Str(i), "GAS1", txtStep(GAS1 + (i - 1) * StepItem).Text, FileName)
        
        Re = WritePrivateProfileString("STEP" & Str(i), "GAS2", txtStep(GAS2 + (i - 1) * StepItem).Text, FileName)
        
        Re = WritePrivateProfileString("STEP" & Str(i), "GAS3", txtStep(GAS3 + (i - 1) * StepItem).Text, FileName)
        
        Re = WritePrivateProfileString("STEP" & Str(i), "GAS4", txtStep(GAS4 + (i - 1) * StepItem).Text, FileName)
        
        Re = WritePrivateProfileString("STEP" & Str(i), "GAS5", txtStep(GAS5 + (i - 1) * StepItem).Text, FileName)
        
        Re = WritePrivateProfileString("STEP" & Str(i), "GAS6", txtStep(GAS6 + (i - 1) * StepItem).Text, FileName)
        
        Re = WritePrivateProfileString("STEP" & Str(i), "GAS7", txtStep(GAS7 + (i - 1) * StepItem).Text, FileName)
    Next i
    
    'DefaultPIDParameter
    If txtRecipeControl(0).Text = "" Then txtRecipeControl(0).Text = "0"
    If txtRecipeControl(1).Text = "" Then txtRecipeControl(1).Text = "0"
    If txtRecipeControl(2).Text = "" Then txtRecipeControl(2).Text = "0"
    If txtRecipeControl(3).Text = "" Then txtRecipeControl(3).Text = "0"
    If txtRecipeControl(4).Text = "" Then txtRecipeControl(4).Text = "0"
    If txtRecipeControl(5).Text = "" Then txtRecipeControl(5).Text = "0"
    If txtRecipeControl(6).Text = "" Then txtRecipeControl(6).Text = "0"
    If txtRecipeControl(7).Text = "" Then txtRecipeControl(7).Text = "0"
   
    Re = WritePrivateProfileString("Control Parameter", "Porprotion", txtRecipeControl(0).Text, FileName)
    Re = WritePrivateProfileString("Control Parameter", "Integral", txtRecipeControl(1).Text, FileName)
    Re = WritePrivateProfileString("Control Parameter", "Derivetive", txtRecipeControl(2).Text, FileName)
    Re = WritePrivateProfileString("Control Parameter", "Feed_Forward", txtRecipeControl(3).Text, FileName)
    Re = WritePrivateProfileString("Control Parameter", "Predict", txtRecipeControl(4).Text, FileName)
    Re = WritePrivateProfileString("Control Parameter", "Shift", txtRecipeControl(5).Text, FileName)
    Re = WritePrivateProfileString("Control Parameter", "Auto Temp Stop", txtRecipeControl(6).Text, FileName)
    Re = WritePrivateProfileString("Control Parameter", "Preheat Power", txtRecipeControl(7).Text, FileName)
      
    Re = WritePrivateProfileString("Control Source", "Input", CStr(cboInputControl.ListIndex), FileName)
    Re = WritePrivateProfileString("Control Source", "Holder", CStr(cboHolder.ListIndex), FileName)
      
    lblRecipeFile.Caption = FileName 'GetFileName(FileName)

    
    gbblnRecipeModify = False
    gbblnRecipePIDModify = False
    Exit Function
    
RecipeSaveError:
    
    gbblnRecipeModify = False
    gbblnRecipePIDModify = False
'
'    lblRecipeFile.Caption = ""
'    Call MessageWarning(Error_2010, vbModal)
End Function

Public Sub ShowText(hsbobject As HScrollBar, txtobject As TextBox)

    Dim lngIndex As Long
    
    lngIndex = hsbobject.Index
    
    Select Case hsbobject.Value
        Case -2
            txtobject.Text = "Keep_PD"
        Case -1
            txtobject.Text = "PumpDown"
        Case 0
            txtobject.Text = "PreHeat"
        Case 1
            txtobject.Text = "Stop"
            'If lngIndex < StepNumber - 1 Then hsbStep(lngIndex + 1).Max = 4
        Case 2
            txtobject.Text = "Idle"
            'If lngIndex < StepNumber - 1 Then hsbStep(lngIndex + 1).Max = 4
        Case 3
            txtobject.Text = "Ramp"
            'If lngIndex < StepNumber - 1 Then hsbStep(lngIndex + 1).Max = 4
        Case 4
            txtobject.Text = "Hold"
            'If lngIndex < StepNumber - 1 Then hsbStep(lngIndex + 1).Max = 4
    End Select
End Sub

Private Sub txtStep_MouseMove(Index As Integer, Button As Integer, Shift As Integer, X As Single, Y As Single)
'    txtStep(Index).ToolTipText = txtStep(Index).Locked & "=" & txtStep(Index).MaxLength
End Sub

Private Sub VScroll1_Change()
    fraRecipe.Top = -240 - VScroll1.Value * 360
End Sub

Public Sub LoadRecipe()
    'Dim m_Recipe As RecipeTable
    Dim i As Integer
    Dim j As Integer
    Dim picTemp(1) As PictureBox
    
    Set picTemp(0) = frmPlotProcess.picProcess(0)
    Set picTemp(1) = frmPlotProcess.picProcess(1)
    
    
    With m_Recipe
        For i = 0 To 49
            For j = 0 To 9
                .arrayRecipe(i, j) = txtStep((10 * i) + j)
                If txtStep((10 * i) + j) = "" Then
                    .arrayRecipe(i, j) = "0"
                End If
            Next j
        Next i
'        frmPlotProcess.ZOrder

        Call Plot_Recipe(m_Recipe, 0, 0, picTemp)
    End With
End Sub
 
'Recipe Paste
Public Sub RecipePaste(lngStep As Long)
    Dim i As Long
    
    For i = 1 To StepItem
        frmRecipe.txtStep((i - 1) + (lngStep - 1) * StepItem).Text = gbstrRecipeOldData(i)
    Next i
End Sub

'Recipe Insert
Public Sub RecipeInsert(lngStep As Long, Optional ByVal bytStepType As Byte = 0)
    Dim i As Long
    Dim strRecipeOldData(1 To StepItem) As String

    For i = 1 To StepItem
        strRecipeOldData(i) = gbstrRecipeOldData(i)
    Next i
    For i = StepNumber To lngStep + 1 Step -1
        Call RecipeCopy(i - 1)
        Call RecipePaste(i)
    Next i
    Select Case bytStepType
        Case 3
            frmRecipe.hsbStep(lngStep - 1).Value = 3
        Case 0
            For i = 1 To StepItem
                If i = 1 Then
                 frmRecipe.txtStep((i - 1) + (lngStep - 1) * StepItem).Text = "Stop"
                Else
                  frmRecipe.txtStep((i - 1) + (lngStep - 1) * StepItem).Text = "0"
                End If
            Next i
    End Select
    For i = 1 To StepItem
     gbstrRecipeOldData(i) = strRecipeOldData(i)
    Next i
End Sub

'Recipe Delete
Public Sub RecipeDelete(lngStep As Long)
    Dim i As Long
    Dim strRecipeOldData(1 To StepItem) As String
    For i = 1 To StepItem
        strRecipeOldData(i) = gbstrRecipeOldData(i)
    Next i
    For i = lngStep To StepNumber - 1
        Call RecipeCopy(i + 1)
        Call RecipePaste(i)
    Next i
    For i = 1 To StepItem
        If i = 1 Then
            frmRecipe.txtStep((i - 1) + (StepNumber - 1) * StepItem).Text = "Stop"
        Else
            frmRecipe.txtStep((i - 1) + (StepNumber - 1) * StepItem).Text = "0"
        End If
    Next i
    For i = 1 To StepItem
        gbstrRecipeOldData(i) = strRecipeOldData(i)
    Next i
End Sub

'Recipe Cut
Public Sub RecipeCut(lngStep As Long)
    Call RecipeCopy(lngStep)
    Call RecipeDelete(lngStep)
End Sub

'Recipe Copy
Public Sub RecipeCopy(lngStep As Long)
    Dim i As Long
    
    For i = 1 To StepItem
        gbstrRecipeOldData(i) = frmRecipe.txtStep((i - 1) + (lngStep - 1) * StepItem).Text
    Next i
End Sub



    
