Attribute VB_Name = "TxtHelp"
Option Explicit

Public Const ProcessStep_Path As String = "\Config\ProcessStep.txt"


Public Function ReadTextFileToArray(filePath As String) As Collection
    Dim fileNumber As Integer
    Dim StringCollection As New Collection
    Dim lineArray() As String
    Dim fileContent As String
    Dim i As Long
    fileNumber = FreeFile
    Open filePath For Input As #fileNumber
    i = 0
    Do While Not EOF(fileNumber)
       Line Input #fileNumber, fileContent
       If fileContent <> "" Then
          StringCollection.Add fileContent
       End If
    Loop
    Close #fileNumber
  Set ReadTextFileToArray = StringCollection
End Function

Public Sub WriteLineToFile(filePath As String, text As String)
    Dim fileNumber As Integer
    fileNumber = FreeFile()
    Open filePath For Append As #fileNumber
    Print #fileNumber, text
    Close #fileNumber
End Sub









Public Sub ModifyTextFile(filePath As String, ColIndex As Long, newText As String)
Dim i As Long
Dim fileNumber As Integer
Dim TxtCol As Collection
fileNumber = FreeFile()
Set TxtCol = ReadTextFileToArray(filePath)
TxtCol.Remove ColIndex
If newText <> "" Then
TxtCol.Add newText, CStr(ColIndex)
End If
Open filePath For Output As #fileNumber
Print #fileNumber, ""
For i = 1 To TxtCol.Count
If TxtCol(i) <> "" Then
Print #fileNumber, TxtCol(i)
End If
Next i
Close #fileNumber
End Sub

