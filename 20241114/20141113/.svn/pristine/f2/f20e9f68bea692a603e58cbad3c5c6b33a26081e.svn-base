VERSION 5.00
Begin VB.Form frmProcessStepBuild 
   Caption         =   "Process Step"
   ClientHeight    =   3420
   ClientLeft      =   60
   ClientTop       =   405
   ClientWidth     =   6270
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3420
   ScaleWidth      =   6270
   StartUpPosition =   3  '窗口缺省
   Begin VB.CommandButton CmdBtn_Query 
      Caption         =   "查詢"
      Height          =   495
      Left            =   2760
      TabIndex        =   22
      Top             =   120
      Width           =   1015
   End
   Begin VB.TextBox Text_Pump 
      Height          =   375
      Left            =   1080
      TabIndex        =   21
      Top             =   2880
      Width           =   1815
   End
   Begin VB.TextBox Text_EX 
      Height          =   375
      Left            =   4080
      TabIndex        =   19
      Top             =   2400
      Width           =   1815
   End
   Begin VB.TextBox Text_APC 
      Height          =   375
      Left            =   1080
      TabIndex        =   17
      Top             =   2400
      Width           =   1815
   End
   Begin VB.TextBox Text_AR 
      Height          =   375
      Left            =   4080
      TabIndex        =   15
      Top             =   1920
      Width           =   1815
   End
   Begin VB.TextBox Text_PN2 
      Height          =   375
      Left            =   1080
      TabIndex        =   13
      Top             =   1920
      Width           =   1815
   End
   Begin VB.TextBox Text_GN2 
      Height          =   375
      Left            =   4080
      TabIndex        =   11
      Top             =   1440
      Width           =   1815
   End
   Begin VB.TextBox Text_Time 
      Height          =   375
      Left            =   1080
      TabIndex        =   9
      Top             =   1440
      Width           =   1815
   End
   Begin VB.TextBox Text_TP 
      Height          =   375
      Left            =   4080
      TabIndex        =   7
      Top             =   960
      Width           =   1815
   End
   Begin VB.CommandButton CmdBtn_Add 
      Caption         =   "+保存"
      Height          =   495
      Left            =   5040
      TabIndex        =   5
      Top             =   120
      Width           =   1095
   End
   Begin VB.ComboBox Combo_Action 
      Height          =   300
      Left            =   840
      TabIndex        =   4
      Top             =   120
      Width           =   1815
   End
   Begin VB.TextBox Text_Action 
      Height          =   375
      Left            =   1080
      TabIndex        =   2
      Top             =   960
      Width           =   1815
   End
   Begin VB.CommandButton CmdBtn_Delete 
      Caption         =   "-作廢"
      Height          =   495
      Left            =   3840
      TabIndex        =   0
      Top             =   120
      Width           =   1095
   End
   Begin VB.Line Line1 
      X1              =   0
      X2              =   6240
      Y1              =   840
      Y2              =   840
   End
   Begin VB.Label Label_Pump 
      Caption         =   "Pump(%-100):"
      Height          =   255
      Left            =   0
      TabIndex        =   20
      Top             =   3000
      Width           =   1095
   End
   Begin VB.Label Label_EX 
      Caption         =   "EX(LM-100):"
      Height          =   255
      Left            =   3120
      TabIndex        =   18
      Top             =   2520
      Width           =   975
   End
   Begin VB.Label Label_APC 
      Caption         =   "APC(mmHg-75):"
      Height          =   255
      Left            =   0
      TabIndex        =   16
      Top             =   2520
      Width           =   1095
   End
   Begin VB.Label Label_AR 
      Caption         =   "AR(LM~5):"
      Height          =   255
      Left            =   3240
      TabIndex        =   14
      Top             =   2040
      Width           =   975
   End
   Begin VB.Label Label_PN2 
      Caption         =   "PN2(LM-20):"
      Height          =   255
      Left            =   120
      TabIndex        =   12
      Top             =   2040
      Width           =   975
   End
   Begin VB.Label Label_GN2 
      Caption         =   "GN2(LM-100):"
      Height          =   255
      Left            =   3000
      TabIndex        =   10
      Top             =   1560
      Width           =   1095
   End
   Begin VB.Label Label_Time 
      Caption         =   "Time(Sec):"
      Height          =   255
      Left            =   240
      TabIndex        =   8
      Top             =   1560
      Width           =   855
   End
   Begin VB.Label Label_TP 
      Caption         =   "T(C)/P(%):"
      Height          =   255
      Left            =   3120
      TabIndex        =   6
      Top             =   1080
      Width           =   975
   End
   Begin VB.Label Label_Action 
      Caption         =   "Action:"
      Height          =   255
      Left            =   480
      TabIndex        =   3
      Top             =   1080
      Width           =   735
   End
   Begin VB.Label Label_Selection 
      Caption         =   "Action:"
      Height          =   255
      Left            =   120
      TabIndex        =   1
      Top             =   120
      Width           =   855
   End
End
Attribute VB_Name = "frmProcessStepBuild"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim TxtRow As Long
'Const ProcessStep_Path As String = App.Path + "\Config\ProcessStep.txt"
'Dim RowNum As Long
Dim TxtNull As Boolean








Private Sub CmdBtn_Add_Click()
Dim SumString As String
If Text_Action.text <> "" Then
  If ActionIsExist(Text_Action.text) = False Then
  SumString = Text_Action.text + ";"
  If Text_TP.text <> "" Then
  SumString = SumString + Text_TP.text + ";"
  Else
  SumString = SumString + "0;"
  End If
  If Text_Time.text <> "" Then
  SumString = SumString + Text_Time.text + ";"
  Else
  SumString = SumString + "0;"
  End If
  If Text_GN2.text <> "" Then
  SumString = SumString + Text_GN2.text + ";"
  Else
  SumString = SumString + "0;"
  End If
  If Text_PN2.text <> "" Then
  SumString = SumString + Text_PN2.text + ";"
  Else
  SumString = SumString + "0;"
  End If
  If Text_AR.text <> "" Then
  SumString = SumString + Text_AR.text + ";"
  Else
  SumString = SumString + "0;"
  End If
  If Text_APC.text <> "" Then
  SumString = SumString + Text_APC.text + ";"
  Else
  SumString = SumString + "0;"
  End If
  If Text_EX.text <> "" Then
  SumString = SumString + Text_EX.text + ";"
  Else
  SumString = SumString + "0;"
  End If
  If Text_Pump.text <> "" Then
  SumString = SumString + Text_Pump.text
  Else
  SumString = SumString + "0"
  End If
  Call WriteLineToFile(App.Path + ProcessStep_Path, SumString)
  Call InitForm
  Else
  Select Case MsgBox("是否要更新此Action", vbYesNo + vbQuestion, "確認")
        Case vbYes
        SumString = Text_Action.text + ";"
        If Text_TP.text <> "" Then
        SumString = SumString + Text_TP.text + ";"
        Else
        SumString = SumString + "0;"
        End If
        If Text_Time.text <> "" Then
        SumString = SumString + Text_Time.text + ";"
        Else
        SumString = SumString + "0;"
        End If
        If Text_GN2.text <> "" Then
        SumString = SumString + Text_GN2.text + ";"
        Else
        SumString = SumString + "0;"
        End If
        If Text_PN2.text <> "" Then
        SumString = SumString + Text_PN2.text + ";"
        Else
        SumString = SumString + "0;"
        End If
        If Text_AR.text <> "" Then
        SumString = SumString + Text_AR.text + ";"
        Else
        SumString = SumString + "0;"
        End If
        If Text_APC.text <> "" Then
        SumString = SumString + Text_APC.text + ";"
        Else
        SumString = SumString + "0;"
        End If
        If Text_EX.text <> "" Then
        SumString = SumString + Text_EX.text + ";"
        Else
        SumString = SumString + "0;"
        End If
        If Text_Pump.text <> "" Then
        SumString = SumString + Text_Pump.text
        Else
        SumString = SumString + "0"
        End If
       Call ModifyTextFile(App.Path + ProcessStep_Path, TxtRow, SumString)
    End Select
  End If
Else
MsgBox "請輸入Action值！"
End If
End Sub

Private Function ActionIsExist(Action As String) As Boolean
Dim Result As Boolean
Dim TxtContent As Collection
Dim RetrunCollection As Collection
Dim TxtLine() As String
Dim i As Integer
Result = False
If Combo_Action.text <> "" Then
Set TxtContent = ReadTextFileToArray(App.Path + ProcessStep_Path)
If TxtContent.Count > 0 Then
TxtNull = False
For i = 1 To TxtContent.Count
TxtLine = Split(TxtContent(i), ";")
If TxtLine(0) = Action Then
Result = True
TxtRow = i
Exit For
End If
Next i
End If
End If
ActionIsExist = Result
End Function

Private Sub RemoveItemFromCombo(itemToRemove As String)
    Dim i As Integer
    For i = 0 To Combo_Action.ListCount - 1
        If Combo_Action.List(i) = itemToRemove Then
            Combo_Action.RemoveItem i
            Exit For
        End If
    Next i
End Sub

Private Sub CmdBtn_Delete_Click()
If Combo_Action.text <> "" Then
If ActionIsExist(Combo_Action.text) = True Then
Call ModifyTextFile(App.Path + ProcessStep_Path, TxtRow, "")
Call RemoveItemFromCombo(Combo_Action.text)
End If
Else
 MsgBox "請先下拉菜單選擇需要作廢的Action！"
End If

End Sub

Private Sub CmdBtn_Query_Click()
Dim TxtContent As Collection
Dim RetrunCollection As Collection
Dim TxtLine() As String
Dim i As Integer
If Combo_Action.text <> "" Then
Set TxtContent = ReadTextFileToArray(App.Path + ProcessStep_Path)
If TxtContent.Count > 0 Then
For i = 1 To TxtContent.Count
TxtLine = Split(TxtContent(i), ";")
If TxtLine(0) = Combo_Action.text Then
  Text_Action.text = TxtLine(0)
  Text_TP.text = TxtLine(1)
  Text_Time.text = TxtLine(2)
  Text_GN2.text = TxtLine(3)
  Text_PN2.text = TxtLine(4)
  Text_AR.text = TxtLine(5)
  Text_APC.text = TxtLine(6)
  Text_EX.text = TxtLine(7)
  Text_Pump.text = TxtLine(8)
End If
Next i
End If
Else
MsgBox "請輸入查詢條件Action！"
End If

End Sub




Private Sub Form_Load()
InitForm
End Sub
Private Function IsDuplicate(item As String) As Boolean
    Dim i As Integer
    For i = 0 To Combo_Action.ListCount - 1
        If Combo_Action.List(i) = item Then
            IsDuplicate = True
            Exit Function
        End If
    Next i
    IsDuplicate = False
End Function

Private Sub InitForm()
Dim TxtContent As Collection
Dim TxtLine() As String
Dim i As Integer
Set TxtContent = ReadTextFileToArray(App.Path + ProcessStep_Path)
If TxtContent.Count > 0 Then
For i = 1 To TxtContent.Count
TxtLine = Split(TxtContent(i), ";")
If IsDuplicate(TxtLine(0)) <> True Then
  Combo_Action.AddItem (TxtLine(0))
End If
Next i
End If
End Sub

'Private Sub InitForm()
'    Dim i As Integer, j, k, L As Integer
'    Dim sngTotalGridWidth As Single
'    Dim S As String
'    Dim s1 As String
'    Dim TxtContent As Collection
'    Dim TxtLine() As String
'    Dim TxtNonGas() As String
'    Dim TxtGas() As String
'    Dim TxtCell As String
'    Set TxtContent = ReadTextFileToArray("D:\123.txt")
'         With HfgProcessStep
'        '.Top = 500
'        .Left = 200
'        .FixedCols = 1
'        .FixedRows = 1
'        .Rows = 51
'        .Cols = 10
'        .ColWidth(0) = 800
'        .ColWidth(1) = 1500
'        For i = 2 To .Cols - 1
'            .ColWidth(i) = 1500
'        Next i
'        For i = 0 To .Cols - 1
'            sngTotalGridWidth = sngTotalGridWidth + .ColWidth(i)
'            .ColAlignmentFixed = flexAlignCenterCenter
'            .ColAlignment(i) = flexAlignCenterCenter
'        Next i
'        .Width = sngTotalGridWidth + 350
'        .TextMatrix(0, GB_PROCESS_STEP) = "Step"
'        .TextMatrix(0, GB_PROCESS_ACTION) = "Action"
'        .TextMatrix(0, GB_PROCESS_TEMP) = "T(℃)/ P(%)"
'        .TextMatrix(0, GB_PROCESS_TIME) = "Time (Sec)"
'
'        For j = 0 To GB_GAS_MAX - 1
'            s1 = gbstrGasUnit(j)
'            If s1 = "SLM" Then s1 = "LM"
'            If s1 = "SCCM" Then s1 = "CM"
'            S = gbstrGasAlias(j) & "(" & s1 & "~" & CStr(gbsngMaxGasSLMP(j)) & ")"
'            .TextMatrix(0, GB_PROCESS_GAS1 + j) = S
'        Next j
'        .RowHeight(0) = CmdBtn_Delete.Height
'         If TxtContent.Count = 0 Then
'            For i = 1 To .Rows - 1
'                .RowHeight(i) = CmdBtn_Delete.Height
'                .TextMatrix(i, GB_PROCESS_STEP) = str(i)
'                .TextMatrix(i, GB_PROCESS_ACTION) = ""
'                .TextMatrix(i, GB_PROCESS_TEMP) = ""
'                .TextMatrix(i, GB_PROCESS_TIME) = ""
'                For j = 0 To GB_GAS_MAX - 1
'                    .TextMatrix(i, GB_PROCESS_GAS1 + j) = ""
'                Next j
'            Next i
'           Else
'            For k = 1 To TxtContent.Count
'             TxtLine = Split(TxtContent(k), "|")
'             TxtNonGas = Split(TxtLine(0), ";")
'                .TextMatrix(k, GB_PROCESS_STEP) = str(k)
'                .TextMatrix(k, GB_PROCESS_ACTION) = TxtNonGas(0)
'                .TextMatrix(k, GB_PROCESS_TEMP) = TxtNonGas(1)
'                .TextMatrix(k, GB_PROCESS_TIME) = TxtNonGas(2)
'              TxtGas = Split(TxtLine(1), ";")
'                For j = 0 To GB_GAS_MAX - 1
'                    .TextMatrix(k, GB_PROCESS_GAS1 + j) = TxtGas(j)
'                Next j
'            Next k
'            End If
'        .Refresh
'        .AllowUserResizing = flexResizeNone
'    End With
'End Sub





'
'Private Sub HfgProcessStep_Click()
'  If HfgProcessStep.ColSel = 1 Then
'        With cmbRecipeAction
'            .Text = HfgProcessStep.TextMatrix(hfgRecipe.RowSel, GB_PROCESS_ACTION)
'            strOriginActionName = HfgProcessStep.TextMatrix(hfgRecipe.RowSel, GB_PROCESS_ACTION)
'            .Move fraRecipe.Left + tabRecipe.Left + hfgRecipe.Left + hfgRecipe.ColPos(hfgRecipe.ColSel) + 20, _
'                      fraRecipe.Top + tabRecipe.Top + hfgRecipe.Top + hfgRecipe.RowPos(hfgRecipe.RowSel) + 25, _
'                  hfgRecipe.ColWidth(hfgRecipe.ColSel)
'            .Visible = True
'            .ZOrder
'            .SetFocus
'        End With
'    Else
'        With txtRecipeEdit
'            .Text = hfgRecipe.TextMatrix(hfgRecipe.RowSel, hfgRecipe.ColSel)
'            .Move fraRecipe.Left + tabRecipe.Left + hfgRecipe.Left + hfgRecipe.ColPos(hfgRecipe.ColSel) + 20, _
'                  fraRecipe.Top + tabRecipe.Top + hfgRecipe.Top + hfgRecipe.RowPos(hfgRecipe.RowSel) + 25, _
'                  hfgRecipe.ColWidth(hfgRecipe.ColSel)
'            .Visible = True
'            .ZOrder
'            .SetFocus
'        End With
'    End If
'    intCurrRowSel = hfgRecipe.RowSel
'    intCurrColSel = hfgRecipe.ColSel
'End Sub
Private Sub Form_Unload(Cancel As Integer)
Call frmRecipeEdit.InitForm
End Sub
